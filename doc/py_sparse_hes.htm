<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>Computing Sparse Hessians</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="Computing Sparse Hessians">
<meta name="keywords" id="keywords" content=" computing sparse hessians syntax purpose f subset x r pattern work n_sweep uses forward example ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_py_sparse_hes_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://github.com/bradbell/cppad_py" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td><a href="sparse_jac_xam.py.htm" target="_top">Prev</a>
</td><td><a href="sparse_hes_xam.py.htm" target="_top">Next</a>
</td><td>
<select onchange='choose_across0(this)'>
<option>Index-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Up-&gt;</option>
<option>cppad_py</option>
<option>library</option>
<option>py_lib</option>
<option>py_sparse</option>
<option>py_sparse_hes</option>
</select>
</td>
<td>
<select onchange='choose_down4(this)'>
<option>cppad_py-&gt;</option>
<option>setup.py</option>
<option>library</option>
<option>whats_new_2018</option>
</select>
</td>
<td>
<select onchange='choose_down3(this)'>
<option>library-&gt;</option>
<option>py_lib</option>
<option>cpp_lib</option>
</select>
</td>
<td>
<select onchange='choose_down2(this)'>
<option>py_lib-&gt;</option>
<option>py_fun</option>
<option>py_sparse</option>
<option>py_utility</option>
<option>more_py</option>
</select>
</td>
<td>
<select onchange='choose_down1(this)'>
<option>py_sparse-&gt;</option>
<option>py_sparse_rc</option>
<option>py_sparse_rcv</option>
<option>py_jac_sparsity</option>
<option>py_hes_sparsity</option>
<option>py_sparse_jac</option>
<option>py_sparse_hes</option>
</select>
</td>
<td>
<select onchange='choose_down0(this)'>
<option>py_sparse_hes-&gt;</option>
<option>sparse_hes_xam.py</option>
</select>
</td>
<td>
<select onchange='choose_current0(this)'>
<option>Headings-&gt;</option>
<option>Syntax</option>
<option>Purpose</option>
<option>f</option>
<option>subset</option>
<option>x</option>
<option>r</option>
<option>pattern</option>
<option>work</option>
<option>n_sweep</option>
<option>Uses Forward</option>
<option>Example</option>
</select>
</td>
</tr></table><br>
@(@\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\R}[1]{ {\rm #1} }@)@<center><b><big><big>Computing Sparse Hessians</big></big></b></center>
<br>
<b><big><a name="Syntax" id="Syntax">Syntax</a></big></b>

<br>

<code><i><font color="black"><span style='white-space: nowrap'>work</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;=&nbsp;cppad_py.sparse_hes_work()<br>
</span></font></code>

<code><i><font color="black"><span style='white-space: nowrap'>n_sweep</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;=&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>f</span></font></i><font color="blue"><span style='white-space: nowrap'>.sparse_hes(</span></font><i><font color="black"><span style='white-space: nowrap'>subset</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>x</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>pattern</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>work</span></font></i><font color="blue"><span style='white-space: nowrap'>)<br>
</span></font></code>
<br>
<b><big><a name="Purpose" id="Purpose">Purpose</a></big></b>
<br>
We use <small>@(@
F : \B{R}^n \rightarrow \B{R}^m
@)@</small> to denote the
function corresponding to 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
.
Given a vector <small>@(@
r \in \B{R}^m
@)@</small>, define
<small>@[@

	H(x) = (r^\R{T} F)^{(2)} ( x )

@]@</small>
This routine takes advantage of sparsity when computing elements
of the Hessian <small>@(@
H(x)
@)@</small>.

<br>
<br>
<b><big><a name="f" id="f">f</a></big></b>
<br>
This object must have been returned by a previous call to the python
<a href="py_fun_ctor.htm" target="_top"><span style='white-space: nowrap'>d_fun</span></a>
 constructor.
Note that the Taylor coefficients stored in 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
 are affected
by this operation; see
<a href="py_sparse_hes.htm#Uses Forward" target="_top"><span style='white-space: nowrap'>uses&nbsp;forward</span></a>
 below.

<br>
<br>
<b><big><a name="subset" id="subset">subset</a></big></b>
<br>
This argument must have be a <a href="py_sparse_rcv.htm#matrix" target="_top"><span style='white-space: nowrap'>matrix</span></a>

returned by the <code><font color="blue">sparse_rcv</font></code> constructor.
Its row size and column size is 
<code><i><font color="black"><span style='white-space: nowrap'>n</span></font></i></code>
; i.e.,

<code><i><font color="black"><span style='white-space: nowrap'>subset</span></font></i><font color="blue"><span style='white-space: nowrap'>.nr()&nbsp;==&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>n</span></font></i></code>
 and 
<code><i><font color="black"><span style='white-space: nowrap'>subset</span></font></i><font color="blue"><span style='white-space: nowrap'>.nc()&nbsp;==&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>n</span></font></i></code>
.
It specifies which elements of the Hessian are computed.
The input value of its value vector

<code><i><font color="black"><span style='white-space: nowrap'>subset</span></font></i><font color="blue"><span style='white-space: nowrap'>.val()</span></font></code>
 does not matter.
Upon return it contains the value of the corresponding elements
of the Jacobian.
All of the row, column pairs in 
<code><i><font color="black"><span style='white-space: nowrap'>subset</span></font></i></code>
 must also appear in

<code><i><font color="black"><span style='white-space: nowrap'>pattern</span></font></i></code>
; i.e., they must be possibly non-zero.

<br>
<br>
<b><big><a name="x" id="x">x</a></big></b>
<br>
This argument is a numpy vector with <code><font color="blue">float</font></code> elements
and size 
<code><i><font color="black"><span style='white-space: nowrap'>n</span></font></i></code>
.
It specifies the point at which to evaluate the Hessian <small>@(@
H(x)
@)@</small>.

<br>
<br>
<b><big><a name="r" id="r">r</a></big></b>
<br>
This argument is a numpy vector with <code><font color="blue">float</font></code> elements
and size 
<code><i><font color="black"><span style='white-space: nowrap'>m</span></font></i></code>
.
It specifies the multiplier for each component of <small>@(@
F(x)
@)@</small>;
i.e., <small>@(@
r_i
@)@</small> is the multiplier for <small>@(@
F_i (x)
@)@</small>.

<br>
<br>
<b><big><a name="pattern" id="pattern">pattern</a></big></b>
<br>
This argument must have be a <a href="py_sparse_rc.htm#pattern" target="_top"><span style='white-space: nowrap'>pattern</span></a>

returned by the <code><font color="blue">sparse_rc</font></code> constructor.
Its row size and column sizes are 
<code><i><font color="black"><span style='white-space: nowrap'>n</span></font></i></code>
; i.e.,

<code><i><font color="black"><span style='white-space: nowrap'>pattern</span></font></i><font color="blue"><span style='white-space: nowrap'>.nr()&nbsp;==&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>n</span></font></i></code>
 and 
<code><i><font color="black"><span style='white-space: nowrap'>pattern</span></font></i><font color="blue"><span style='white-space: nowrap'>.nc()&nbsp;==&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>n</span></font></i></code>
.
It is a sparsity pattern for the Hessian <small>@(@
H(x)
@)@</small>.
This argument is not used (and need not satisfy any conditions),
when <a href="py_sparse_hes.htm#work" target="_top"><span style='white-space: nowrap'>work</span></a>
 is non-empty.

<br>
<br>
<b><big><a name="work" id="work">work</a></big></b>
<br>
This argument must have been constructed by the call

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>work</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;=&nbsp;cppad_py.sparse_hes_work()<br>
</span></font></code>
We refer to its initial value,
and its value after 
<code><i><font color="black"><span style='white-space: nowrap'>work</span></font></i><font color="blue"><span style='white-space: nowrap'>.clear()</span></font></code>
, as empty.
If it is empty, information is stored in 
<code><i><font color="black"><span style='white-space: nowrap'>work</span></font></i></code>
.
This can be used to reduce computation when
a future call is for the same object 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
,
and the same subset of the Hessian.
If either of these values change, use 
<code><i><font color="black"><span style='white-space: nowrap'>work</span></font></i><font color="blue"><span style='white-space: nowrap'>.clear()</span></font></code>
 to
empty this structure.

<br>
<br>
<b><big><a name="n_sweep" id="n_sweep">n_sweep</a></big></b>
<br>
The return value 
<code><i><font color="black"><span style='white-space: nowrap'>n_sweep</span></font></i></code>
 has prototype

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>n_sweep</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>
It is the number of first order forward sweeps
used to compute the requested Hessian values.
Each first forward sweep is followed by a second order reverse sweep
so it is also the number of reverse sweeps.
This is proportional to the total computational work,
not counting the zero order forward sweep,
or combining multiple columns and rows into a single sweep.

<br>
<br>
<b><big><a name="Uses Forward" id="Uses Forward">Uses Forward</a></big></b>
<br>
After each call to <a href="py_fun_forward.htm" target="_top"><span style='white-space: nowrap'>py_fun_forward</span></a>
,
the object 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
 contains the corresponding Taylor coefficients
for all the variables in the operation sequence..
After a call to <code><font color="blue">sparse_hes</font></code>
the zero order coefficients correspond to

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>f</span></font></i><font color="blue"><span style='white-space: nowrap'>.forward(0,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>x</span></font></i><font color="blue"><span style='white-space: nowrap'>)<br>
</span></font></code>
All the other forward mode coefficients are unspecified.


<br>
<br>
<b><big><a name="Example" id="Example">Example</a></big></b>

<br>
<a href="sparse_hes_xam.py.htm" target="_top"><span style='white-space: nowrap'>sparse_hes_xam.py</span></a>



<hr>Input File: lib/python/sparse_hes.py

</body>
</html>
